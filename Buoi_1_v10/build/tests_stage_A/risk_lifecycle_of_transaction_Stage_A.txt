
Giáº£ sá»­ báº¡n táº¡o má»™t Transaction báº±ng malloc() nhÆ° sau:


ğŸ§¨ TrÆ°á»ng há»£p báº¡n viáº¿t:
Transaction* t = (Transaction*)malloc(sizeof(Transaction));
t->book = (Book*)malloc(sizeof(Book));
t->user = (User*)malloc(sizeof(User));


ğŸ“Š SÆ  Äá»’ 1: Transaction dÃ¹ng malloc (âŒ KHÃ”NG KHUYáº¾N KHÃCH TRÃŠN STM32)
RAM Layout:

+-------------------------------+ â† Stack cao
| Return address                |
| Previous frame pointer        |
|-------------------------------|
| t (Transaction*)              | â†’ trá» vÃ o vÃ¹ng heap
+-------------------------------+

             â†“
+===============================================+
| Heap                                          |
|-----------------------------------------------|
| Transaction                                   |
| â”œâ”€ id                                         |
| â”œâ”€ book (Book*) â”€â”                            |
| â”œâ”€ user (User*) â”€â”˜                            |
| â””â”€ is_active                                  |
|                                               |
| â€¢ book â†’ struct Book { ... } (trÃªn heap)      |
| â€¢ user â†’ struct User { ... } (trÃªn heap)      |
+===============================================+
| Global/static memory                          |
| â€¢ KhÃ´ng sá»­ dá»¥ng library.books/users[]         |
+===============================================+


â— Váº¥n Ä‘á»:
Báº¡n pháº£i free(t->book); free(t->user); free(t);

Náº¿u quÃªn free, â†’ rÃ² rá»‰ RAM (nguy hiá»ƒm trÃªn STM32 vÃ¬ RAM nhá»).

Phá»©c táº¡p hÃ³a quáº£n lÃ½ bá»™ nhá»› â†’ KHÃ”NG phÃ¹ há»£p cho nhÃºng hoáº·c STM32.

